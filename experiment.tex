\chapter{Experiment description\label{sec:experiment}}

\section{Large Hadron Collider\label{sec:lhc}}

The Large Hadron Collider (see~\cite{1748-0221-3-08-S08001} for a detailed description) is a circular accelerator and collider of high-energy particles, straddling the French-Swiss border near Geneva, Switzerland. Constructed between 1998 and 2008, the accelerator consists of 2 rings for counter-circulating proton or ion beams, 27 km in circumference and located at depths as low as 175 m underground in the tunnel previously occupied by the LEP collider ring. Superconducting magnets, composed of NbTi Rutherford conductors cooled to temperatures below 2 K with superfluid helium, generate magnetic fields above 8 T and serve to steer and focus the particle beams (either protons or lead ions) in their trajectory through the accelerator rings.

Protons, derived by ionizing hydrogen gas, are accelerated first via a linear accelerator to an energy of 50 MeV and injected into the Proton Synchrotron Booster, which accelerates them to 1.4 GeV. From there, they are injected into the Proton Synchrotron, which accelerates them further to 25 GeV, and then into the Super Proton Synchrotron, which brings them to an energy of 450 GeV before finally injecting them into the LHC ring, in which they are accelerated to the desired center-of-mass energy for collisions. The LHC has been designed to collide protons at a maximum center-of-mass energy of 14 TeV. During its first run, it operated at center-of-mass energy 7 TeV from 2010-2012, and then at 8 TeV from 2012-2013. After a long shutdown for planned repairs and maintenance, the LHC was restarted in 2015, operating at 13 TeV, with the intention of eventually increasing to 14 TeV.

The LHC is home to several experiments -- the general-purpose high-luminosity detectors ATLAS (A Toroidal LHC Apparatus) and CMS (Compact Muon Solenoid), low-luminosity detectors LHCb (focusing on B physics) and TOTEM (focusing on elastic proton scattering), and the heavy-ion detector ALICE. At each detector, the proton beams are focused together by quadrupole magnets at an interaction point, where they collide, and the particles produced in these collisions are detected and recorded by the detector system. The rest of this chapter will focus on the CMS experiment, where the research described in this thesis was conducted.

\section{Compact Muon Solenoid\label{sec:cms}}

The Compact Muon Solenoid (CMS) detector is a hermetic general-purpose detector at the LHC, gathering data from the collision of proton-proton and heavy ion beams to study a wide range of physics processes. This experiment is characterized by a powerful superconducting solenoid magnet that produces a 4 T magnetic field; the paths of charged particles are bent by the magnetic field, allowing their momenta to be accurately reconstructed from their trajectories. Quadrupole magnets bend the two proton beams passing through the LHC ring to intersect and collide at the interaction point (IP) in the center of the CMS detector, and the particles produced in the collision pass through and are recorded by the layered system of cylindrical subdetectors that comprise the CMS detector. The entire detector is a cylindrical structure 21.6 m in length (along the z axis) and 14.6 m in diameter. At the center of the ensemble is a silicon tracker subdetector for reconstructing accurately the momenta of charged particles. Encircling it is the electromagnetic calorimeter (ECAL), a homogenous calorimeter that uses scintillating lead tungstate crystals to reconstruct electrons and photons with high energy resolution. Outside the electromagnetic calorimeter is the hadron calorimeter (HCAL), a sampling calorimeter with alternating layers of brass and scintillator that measures the energy deposited in hadronic showers. The solenoid magnet is located outside the hadronic calorimeter, together with an iron yoke system that provides a return flux for the magnetic field. The outermost layer of the CMS detector is the muon tracking system for identifying and reconstructing the trajectories of muons. The solenoid magnet and the various subdetectors of CMS will be described in more detail in the rest of this chapter, followed by considerations regarding the mechanisms for data collection by CMS. A more complete description of the detector can be found at~\cite{1748-0221-3-08-S08004}; unless otherwise specified, all information in this chapter is derived from this source.

\subsection{Magnet\label{sec:cms-magnet}}
% solenoid, yoke, cryogenics, vacuum system

The superconducting solenoid magnet of CMS encloses the tracker detector, ECAL, and part of the HCAL inside a cylindrical bore 6.3 m in diameter and 12.5 m long, weighing 220 tonnes. The solenoid is composed of a 4-layer winding of coils made of NbTi, which is mechanically reinforced by being mixed with an aluminium alloy, an innovative method that makes the coils serve both as conductors and as their own self-stabilizing structural support. At full current, the solenoid carries 19.14 kA, producing a nearly uniform 4 T magnetic field through the volume enclosed by the bore, containing 2.6 GJ of stored energy. The magnetic flux is returned through an iron yoke, consisting of a system of barrel wheels and endcap disks arranged outside the volume of the solenoid in a cylindrical pattern and interleaved with the muon tracking system; the yoke is segmented longitudinally into 5 rings, each 2.536 m long in the z direction, with their centers positioned at z = -5.342 m, -2.686 m, 0 m, +2.686 m, and +5.342 m (rings number -2, -1, 0, 1, and 2 respectively).

\subsection{Tracker\label{sec:cms-tracker}}

5.8 m in length along the z axis and 2.5 m in diameter, the tracker detector is the innermost layer of the CMS detector system. Its purpose is to reconstruct the paths and momenta of charged particles with transverse momentum 1 GeV and upwards, and to provide good impact parameter resolution for accurately reconstructing the positions of secondary vertices, which are displaced from the point of collision and generally are a characteristic signature of long-lived particles such as those from heavy-flavour processes. Since the tracker detector receives higher irradiation than any other part of the detector due to its proximity to the beam line and the interaction point (IP), the tracker detector has been designed to survive and operate in a high-flux environment, with thousands of particles passing through its volume every 25 ns when the LHC is running at its design luminosity. Thus, the tracker has been designed with these challenges in mind in order to yield good position and time resolution.

The tracker detector is composed of two subdetectors. The one closest to the beam line is the pixel detector; its sensors are 100 $\mu$m x 150 $\mu$m pixels, which receive an occupancy on the order of $10^{-4}$ per pixel per bunch crossing. The second and larger subdetector is the silicon strip tracker, whose sensors are silicon strips; since it is located at larger radii than the pixel detector, the fluence of particles that reach it is lower and thus the granularity of the silicon strips can be considerably lower than that of the pixel detector, with strip areas ranging from 10 cm x 80 $\mu$m at intermediate radii for the inner strip tracker (20 $<$ r $<$ 55 cm) and 25 cm x 180 $\mu$m for the outer strip tracker (55 $<$ r $<$ 110 cm), resulting in an occupancy of about 2-3\% for the inner tracker and 1\% for the outer tracker. In total, the CMS tracker detector is comprised of 200 $m^{2}$ of active silicon sensors, providing a coverage of up to $\abs{\eta}$ $<$ 2.5.

The support structures that hold the sensors in position are designed to minimize the amount of material used, since energy loss via multiple scattering and extraneous particles produced by nuclear interactions, gamma conversions, and bremsstrahlung in the supporting material can all interfere with tracking efficiency. Because of the high particle fluence passing through the tracker volume during operation, radiation-hard sensors and electronics are required to withstand the radiation dosage; also, an efficient system system of cooling tubes carrying chilled liquid $C_{6}F_{14}$ pervades the tracker volume, keeping it at or below -10 C during operation, thus minimizing radiation damage to the sensors caused either by direct irradiation or by the annealing of radiation-induced defects in the silicon crystal structure through thermal agitation.

\subsubsection{Pixel detector\label{sec:cms-pixel}}
% barrel and disks, design of sensors, electronics, readout

The pixel detector is the innermost layer of the tracker detector, with three concentric cylindrical barrel layers complemented by two endcap disks on either side of the interaction point. The barrel layers are located at radii 4.4, 7.3, and 10.2 cm from the beam line, extending out to 2.9 m from the interaction point in the $\pm$z directions. Two endcap disks are located at z $=$ $\pm$34.5 cm and $\pm$46.5 cm, with inner radius 6 cm and outer radius 15 cm. Both the barrel cylinders and endcap disks are split in halves along the y axis for ease of extraction and access. Each sensor has an area of 100 $\mu$m x 150 $\mu$m; the nearly square design is intended to provide good cluster size and hit resolution in both r$\phi$ and z for the barrel and r$\phi$ and r for the endcaps, as both of these coordinates are needed for measuring track impact parameters.

In the barrel, the sensors are arranged 2 x 8 on rectangular modules (or 1 x 8 along the edges of the half-cylinders). In each endcap half-disk, 12 trapezoidal support structures called blades hold the sensors, which come in arrangements of five different plaquette sizes (1 x 2, 2 x 3, 2 x 4, 1 x 5, and 2 x 5) in order to achieve full coverage of the wedge-shaped area of the blade. Altogether, the pixel detector covers a pseudorapidity range of $\abs{\eta}$ $<$ 2.5.

The pixel sensors consist of 52 x 80 high-dose $n$-type pixels implanted in a high-resistance $n$-type substrate of 320 $\mu$m thickness on a sensor plate. Each pixel is bump-bonded onto a readout chip (ROC) connected to the sensor plate. The ROC collects and amplifies the analog signals from the pixels, storing them in a buffer until the arrival of the appropriate readout control and clock signals causes it to pass the sensor signal on to the readout system.
 
When a charged particle passes through a silicon sensor, it induces charge carriers in the n-doped silicon substrate; traveling towards the pixels to be collected, electrons undergo a signficant Lorentz drift (roughly 32$^{\circ}$) due to the 4 T magnetic field along the z axis through the tracker volume, and thus the signal current ends up being spread over adjacent pixels. Interpolation between signals from multiple neighbouring pixels can be used to improve hit resolution. In the barrel, the normal direction of the pixel cells points along the radial direction, perpendicular to the magnetic field, so the Lorentz drift is along the r$\phi$ direction. To induce charge sharing in the pixel endcaps, whose normal points along the magnetic field axis, the blades are rotated at a 20$^{\circ}$ angle about their radial axis in a turbine-like geometry.

\subsubsection{Silicon strip detector\label{sec:cms-strips}}
% barrel and disks, design of sensors, electronics, readout

Outside the pixel detector, at radius 20 cm to 116 cm about the beam line and extending 118 cm in the +z and -z directions, lies the silicon strip detector. It is composed of 3 main subsystems: the tracker inner barrel and disks (TIB and TID), the tracker outer barrel (TOB), and the tracker endcaps (TEC). To optimize coverage, the silicon microstrip sensors in any given barrel layer or endcap disk are positioned to partially overlap with one another, thus resulting in a nonzero pitch with respect to the surface to which they are attached.

The TIB consists of 4 barrel layers 140.0 cm in length, with radii of 255.0 mm, 339.0 mm, 418.5 mm, and 498.0 mm, altogether providing up to 4 r-$\phi$ measurements per particle trajectory. The sensors are silicon microstrips with a thickness of 320 $\mu$m, lying parallel to the beam axis, with a pitch of 80 $\mu$m on the inner two layers and 120 $\mu$m on the outer two layers, yielding a single-point resolution of 23 $\mu$m for the inner two layers and 35 $\mu$m for the outer two layers. The TID is comprised of six endcap disks, three at each end of the TIB between $\pm$80.0 cm and $\pm$90.0 cm on the z axis; each disk consists of three support rings from radius 200 $\mu$m to 500 $\mu$m. Silicon microstrips, similar to the ones used in the barrel, lie radially on the disks, with a pitch varying from 100 $\mu$m to 141 $\mu$m. While the pixel detector is split down the y axis into half-cylinders for ease of installation, access, and independent testing, the TIB and TID are split into half-shells along the x axis for similar reasons. Two carbon-fibre service cylinders are coupled to the $\pm$z ends of the TIB, providing a route to the TIB shells for service cables originating from a service distribution disk called a margherita, and also housing the TID.

The TOB surrounds the TIB with 6 barrel layers, reaching to an outer radius of 116 cm and spanning 118 cm in the $\pm$z directions. The silicon microstrip sensors here are 500 $\mu$m thick and have a pitch of 183 $\mu$m in the inner four layers and 122 $\mu$m in the outer two layers, yielding a single-point resolution of 53 $\mu$m and 35 $\mu$m respectively in those layers. On either end of the TOB, the TEC extends radially from 220 mm to 1135 mm and in the $\pm$z direction from $\pm$1240 mm to $\pm$2800 mm; each side consists of an assembly of 9 disks with up to 7 rings bearing silicon microstrip sensors, plus 2 extra disks that serve as front-back termination. The microstrip sensors used here have a thickness of 320 $\mu$m in the four rings closest to the TOB and 500 $\mu$m in the remaining outer rings, with a pitch varying from 97 to 184 $\mu$m.

The silicon microstrip sensors have a single-sided $p$-on-$n$ design. Signal currents are amplified and stored by a custom integrated circuit called an APV25 before being transmitted via optical fibers through the readout system for digitization and storage.

\subsection{Electromagnetic calorimeter\label{sec:cms-ecal}}
% crystals, photodetectors, readout, preshower

The electromagnetic calorimeter (ECAL) is a hermetic homogeneous calorimeter made up of lead tungstate (PbWO$_4$) crystals; similar to the inner tracking system, it is composed of a cylindrical barrel system (with a total of 61,200 crystals) and an endcap system (one endcap disk on each side of the barrel, with 7324 crystals per disk). The total thickness of the ECAL is larger than 25 radiation lengths $X_0$. When electrons or photons pass through, the resulting electromagnetic showers that they generate excite the scintillator atoms, causing them to emit blue-green scintillation light (up to 420-430 nm in wavelength) that is collected, amplified, and read out by photodetectors glued to the ends of the crystals. High granularity is needed for good energy resolution in the ECAL; the choice of PbWO$_4$, with a density of 8.28 g/cm$^3$, a radiation length of 0.89 cm, and a Moliere radius of 2.2 cm, allows for compact, granular crystals that can resist radiation damage under the high particle fluences that the detector is subjected to throughout its operation. As the number of scintillation photons produced by the crystals and the amplification provided by the photodiodes both tend to decrease with increasing temperature, the temperature of the ECAL detector needs to be maintained at a steady operating temperature during its operation; this is done by a cooling system that uses water as a coolant, maintaining the ECAL at a stable temperature of 18$^{\circ}$ C with an uncertainty of $\pm$0.05$^{\circ}$ C.

The barrel extends from an inner radius of 1.29 m to an outer radius of 1.77 m. In the barrel, the detector granularity is 360-fold in $\phi$ and 170-fold in $\eta$. The crystals have a truncated pyramidal shape that varies with their position in $\eta$, with a cross-sectional area of approximately 22x22 mm$^2$ at the front face (closest to the beam line) and 26x26 mm$^2$ at the rear face, and a length of 230 mm (corresponding to 25.8 radiation lengths). Groups of 2x5 barrel modules are referred to as sub-modules, encased within a 0.1-mm thick wall consisting of an aluminium layer facing the crystal, followed by two layers of glass fibre-epoxy resin. Submodules are grouped together into larger groups called modules containing 400 or 500 crystals, whose shape depends on the position in $\eta$ of the module. Four modules form a supermodule, and 18 supermodules form half a barrel.

On either side of the barrel, the ECAL endcaps cover the pseudorapidity range 1.479 $<$ $\abs{\eta}$ $<$ 3.0. Endcap crystals have a truncated pyramidal shape similar to barrel crystals, with a front face cross-sectional area of about 28.62x28.62 mm$^2$ and a rear face cross-sectional area of 30z30 mm$^2$, and a length of 220 mm (24.7 radiation lengths). They are arranged in groups of 5x5 known as supercrystals, enclosed in a carbon-fibre alveolar wall. Each half of an endcap disk, called a Dee, is composed of 138 full supercrystals and 18 partial supercrystals.

Sandwiched between the barrel and each endcap disk is a disk-shaped sampling calorimeter with a thickness of 20 cm; these two disks make up the preshower detector. Its main purposes are neutral pion identification and rejection in the fiducial region 1.653 $<$ $\abs{\eta}$ $<$ 2.6, identify electrons against the background of minimum ionizing particles, and improve the position resolution of electrons and photons in the ECAL. The preshower is two layers thick; each layer consists of a layer of lead radiators for initiating electromagnetic showers, followed by a layer of silicon strip sensors for detecting the showers.

To take advantage of total internal reflection for the collection of scintillation light, all the ECAL crystals have been precisely polished during production. The crystals have a truncated pyramidal shape, which would tend to cause nonuniform light collection along the length of barrel crystals; thus, in the barrel crystals, one crystal face is left unpolished to compensate for this effect. This technique is not used in the endcaps because the endcap crystal faces are nearly parallel to one another, thus resulting in more uniform light collection. The different magnetic field configuration and particle flux in the barrel and endcaps led to different choices of photodetectors for those two systems: avalanche photodiodes (APDs) for the barrel and vacuum phototriodes (VPTs) in the endcaps. At 18$^{\circ}$ C, approximately 4.5 photoelectrons per MeV of deposited energy are collected by both APDs and VPTs. For electron or photon energies below 500 GeV, the ECAL energy resolution can be estimated as follows:

\begin{equation}
(\frac{\sigma}{E})^2 = (\frac{S}{\sqrt{E}})^2 + (\frac{N}{E})^2 + C^2
\end{equation}

In this equation, S is the stochastic term, N is the noise term, and C is the constant term. The stochastic term S comes from stochastic fluctuations in electromagnetic shower containment, a photostatistics contribution of 2.1\% coming from the uncertainty on the number of primary photoelectrons produced per MeV of deposited energy, and fluctuations in the energy deposited in the preshower absorber. The term N accounts for noise due to electronics, the signal digitization process, and energy deposited by pileup particles. Finally, the constant term C covers various sources of systematic error including the nonuniformity of light collection due to crystal shape, intercalibration errors, and leakage of energy from the back of the crystal.

\subsection{Hadronic calorimeter\label{sec:cms-hcal}}
% HB, HE, HO, HF -- scintillator, absorber, readout

Surrounding the ECAL is the hadronic calorimeter (HCAL), a sampling calorimeter extending radially from 1.77 m to 2.95 m from the beam line. Its main goals are to measure the energy deposited by hadronic jets in each event, and to measure indirectly the missing energy due to neutrinos and any potential exotic particles. The HCAL is split up into four subsystems, of which the innermost are the HCAL barrel and endcaps. To provide enough calorimeter material to absorb hadronic showers for jet and missing energy measurement while respecting the spatial constraints from ECAL within and the superconducting solenoid without, the barrel and endcaps are supplemented respectively by the outer calorimeter outside the solenoid and the forward calorimeters outside the muon endcaps. Altogether, these four subsystems provide coverage up to $\abs{\eta}$ $<$ 5.2.

The barrel system (HB) covers up to $\abs{\eta}$ $<$ 1.3. It is subdivided transversally into two half-barrels, each of which consists of 18 identical wedges (making a total of 36 HB wedges). The wedges are subdivided into 4 azimuthal sectors staggered for optimum coverage, and they hold the absorber plates and scintillator material. The HB absorber is made up of an innermost 40-mm-thick steel front plate, eight 50.5-mm-thick brass plates, six 56.5-mm brass plates, and an outermost 75-mm-thick steel back plate. Passing hadrons interact with the nuclei of the absorber, producing hadronic showers of quarks and gluons. The energy in these showers is deposited in and measured by 17 layers of scintillator material that are interspersed between the absorber plates; layers in azimuthal sectors 1 and 4 fit into slots in the edges of a wedge, while layers in azimuthal sectors 2 and 3 fit into slots in the middle of a wedge. Besides the division into 18 sectors in $\phi$, the scintillator material is also split into 16 sectors in $\eta$, resulting in a granularity of (0.087, 0.087) in ($\eta$, $\phi$).

The smallest scintillator unit is called a tile; tiles in layer 0 are made of Bicron BC408 and primarily serve to sample hadronic showers that develop between the HB and the ECAL barrel, while tiles in layers 1-16 are made of of Kuraray SCSN81 plastic scintillator. Tiles in a given azimuthal layer are grouped into units called trays for ease of assembly, access, and individual testing; each barrel layer contains a total of 108 trays. The scintillation light produced in each tile is collected by a Kuraray Y-11 wavelength-shifting (WLS) fibre. Each WLS fibre is spliced to a clear Kuraray double-clad fibre that serves all the tiles in the tray and delivers the collected light to an optical decoding unit, which arranges the clear fibres into readout towers and transmits their signals to a hybrid photodiode (HPD) for amplification and readout. Multipixel HPD's were chosen because of the wider range of wavelengths that they can detect and their low sensitivity to magnetic fields; those used in the HB, HE, and HO have a gain of ~2000.

The endcap system (HE) disks on either side of the HB are mounted onto the iron yoke of the muon endcap system and span the pseudorapidity range 1.3 $<$ $\abs{\eta}$ $<$ 3. The HE disks are subdivided azimuthally into 36 identical wedges and 18 layers, with 79-mm-thick brass absorber plates. The active material in the trapezoidal scintillator tiles is Bicron BC408 for layer 0 and SCSN81 for the remaining 17 layers. The HE contains a total of 20916 tiles, arranged into 1368 trays, with a granularity of (0.087, 0.087) in ($\eta$, $\phi$) for $\abs{\eta} <$ 1.6 and (0.087, 0.087) for $\abs{\eta}$ $\geq$ 1.6. The collection of scintillation light by WLS fibres and the transmission of the collected signal from tray to HPD for readout is similar to the design of the HB.

The cylindrical outer calorimeter (HO) is located outside the solenoid, taking advantage of the solenoid coil as an additional sampling layer for late-starting hadronic showers. The thickness in hadronic interaction lengths $\lambda_I$ of the HE + HB ensembles varies with $\eta$ between 7-11 $\lambda_I$; when the HO is considered, the total thickness varies from 10-15 $\lambda_I$. The HO layers are mounted within the iron yoke that returns the magnetic field of the solenoid; they are the first sensitive layer in each of the 5 rings of the yoke. Ring 0 of the yoke has two layers of HO scintillators on either side of a 19.5-cm thick iron barrel at radii 3.82 and 4.07 m, while the other four rings have one layer of HO scintillator at radius 4.07 m. Each layer of the HO is divided into 12 sectors in $\phi$, each separated by the dead space of 75-mm-thick steel beams that are part of the support structure of the return yoke and the muon system. The HO layers are 40 mm thick, of which 16 mm corresponds to the detector layer and the rest is occupied by aluminium support structures. The tiles in the HO are grouped into towers with a granularity of (0.087, 0.087) in ($\eta$, $\phi$) and have a similar WLS scintillation light collection and HPD readout to the HE and HB trays. Each HO tray spans 5$^{\circ}$ in $\phi$ and the entire range of a muon ring in $\eta$. Studies done to assess the effect of the HO on pion energy measurement by the HCAL show that the inclusion of energy measurements in the HO significantly recovers the effects of hadronic shower energy leakage, which thus directly improves the accuracy of missing transverse energy (MET) measurement in an event.

The forward calorimeters (HF)  are located far down the beamline, with the front face of each cylinder at 11.2 m from the interaction point of the CMS detector. The inner radius is 12.5 cm from the beam line, and the outer radius is at 130 cm. Unlike the HB, HE, and HO, the HF calorimeters use quartz fibres rather than plastic as the scintillation medium, so as to withstand the heavy particle fluxes (an average deposited energy of 760 GeV per proton-proton interaction, compared with ~100 GeV for the rest of the HCAL) in the forward region that they occupy. Each HF cylinder is divided azimuthally into eighteen 20$^{\circ}$ wedges; the absorber is composed of 5-mm-thick steel plates with grooves into which the scintillation fibres are inserted. The absorber is subdivided into two parts in $\eta$; in one half, the fibres run through the full depth of the absorber, while in the other half, the fibres start at a depth of 22 cm from the front of the detector. With this design, the HF can distinguish between electromagnetic and hadronic showers, since the former tend to deposit most of their energy within the first 22 cm and the latter deposit nearly equal energy in both segments. 

The quartz fibres are made of a fused-silica core with polymer hard-cladding. Charged particles passing through the crystals with energy above the Cherenkov threshold (roughly 190 keV for electrons) will generate Cherenkov radiation, which is captured by the quartz fibres. The fraction of light $f_{trap}$ captured by a crystal is equal to NA/2n$_{core}^2$, where NA is the numerical aperture and n$_{core}$ is the refractive index of the quartz core. The light that hits the core-cladding interface at an angle larger than the critical angle of 71$^{\circ}$ can contribute to the calorimeter signal, while the rest is lost. The fibres run in bundles parallel to the beam line, forming towers with a granularity of (0.175, 0.175) in ($\eta$, $\phi$). Bundles of fibres emerging from the back of the calorimeter are routed to air-core light guides protected by a shielding matrix of steel, lead, and polyethylene. The interior of a light guide is coated with highly reflective metal and guides the received light from the quartz fibres to a photomultiplier for readout; one readout box holds 24 photomultipliers and services half of a wedge.

In addition to contributing to hadronic shower energy measurement, the HF is also used to monitor the luminosity of the LHC. The average number of empty towers in the HF is related to the mean number of interactions per bunch crossing, and there is also a linear relationship between luminosity and the average transverse energy per tower.

\subsection{Muon system\label{sec:cms-muon}}
% DT, CSC, RPC, readouts for all
Since high-energy muons can penetrate several kilometres of solid matter without losing much energy via interactions with the medium, they are expected to be the only particles (not counting neutrinos) that survive past the tracker and calorimeter layers of the CMS detector. Thus, the muon detector of the CMS experiment is its outermost layer, located outside the solenoid. Like the rest of the CMS subsystems, the muon system is comprised of a barrel region and two endcap regions. The muon detector chambers are mounted on the flux return yoke system. The barrel is made of four layers called stations, and its longitudinal segmentation is dictated by the segmentation of the yoke into 5 rings, while the azimuthal segmentation comes from the iron ribs of the yoke that serve as support structures for the solenoid coil cryostat and the HCAL outer calorimeter~\cite{MuonTDR}. The goals of the muon system are to provide good reconstruction of muon momentum and charge over the entire kinematic range of the LHC, as well as to provide the capability to trigger on events in the detector (the concept of triggering is explained in Section~\ref{sec:cms-triggerdaq}). To these ends, the muon system employs three different kinds of gas ionization detector technology: drift tubes (DTs), cathode strip chambers (CSCs), and resistive plate chambers (RPCs).

The DT system is located only in the barrel of the muon detector; the choice to use DTs was based on the low expected particle flux and low magnetic field in the barrel. The smallest sensitive element is the drift cell, with a transverse dimension of 21 mm and an anode wire of roughly 2.4 m in length. The cells contain an 85\%:15\% mixture of Argon and CO$_2$ gas; when a charged particle passes through, the ionization of the gas results in a charge carrier cascade that is picked up by the anode and cathode wires and amplified by the readout system. Drift cells are grouped into four layers staggered by half a cell; these groups of four layers are independent units known as superlayers (SLs). SLs are further grouped into groups of either 2 or 3 to form a drift chamber. Drift chambers with only SL's have wire anodes running only in the r-$\phi$ direction and provide only a measurement of the $\phi$ coordinate of a hit; these chambers are only located in the fourth muon station. In the inner three muon stations, the chambers are composed of 3 SL's, of which the outermost two have wire anodes running in the r-$\phi$ direction and the other has the wire running in the z direction, thus yielding both r-$\phi$ and z coordinates of a hit. The inner three muon stations have 60 drift tube chambers each, while the fourth station has 70.

CSC's were chosen for the endcap region of the muon detector where the particle flux is higher. The cathode strip chambers are trapezoidal multi-wire proportional counters, with 6 anode wires running along the azimuthal direction and 7 cathode strips running perpendicular to the wires in the radial direction. Thus, the passage of a particle through a CSC will yield a measurement in both r and $\phi$ coordinates (from the charges induced in the anode and cathode strips respectively), with spatial resolution within 80 $\mu$m. There are 468 cathode strip chambers in total, providing coverage over the pseudorapidity range 0.9 $< \abs{\eta} <$ 2.4. The gas used in the chambers is a mixture of argon, CO$_2$, and CF$_4$ in a ratio of 40\%:50\%:10\%, with the CF$_4$ included to prevent polymerization on the wires. The CSC system has two purposes: to yield a precise measurement of muon tracks, and to provide information for triggering. Local charged track (LCT) boards sample all the anode and cathode strip readouts of all chambers in synchronization with every LHC bunch crossing. Algorithms seek patterns of hits in the output read out by the anode and cathode LCT boards; if patterns are found that are consistent with muon tracks, they serve as trigger primitives and are used for building muon track candidates.

Finally, there is the RPC system, which consists of gaseous parallel-plate detectors arranged into six barrel layers and three layers per endcap. The gas used in the chambers is a mixture of C$_2$H$_2$F$_4$, $i$C$_4$H$_{10}$, and SF$_6$ in a ratio of 96.2\%:3.5\%:0.3\%, with water vapour added to achieve 45\% relative humidity in order to avoid changes in the resistivity of the bakelite plates. The six RPC barrel layers are embedded in the iron yoke, with two in each of the first and second muon stations and one in each of the third and fourth stations. With the current endcaps, the RPC system extends out to $\abs{\eta}$ = 1.6, with future plans to install an additional fourth endcap layer that would provide coverage out to $\abs{\eta}$ = 2.1. An RPC chamber in the barrel has a rectangular shape and consists of 2 or 3 double-gap modules with up to 96 strips per double-gap, in which the strips run parallel to the beam direction; there are a total of 480 barrel chambers. In the endcap, chambers also have a double-gap structure but are trapezoidal in shape; each chamber has 32 strips running radially and covers 20$^{\circ}$ in $\phi$ in the innermost ring and 10$^{\circ}$ in $\phi$ in the outermost ring. Front-end electronics boards are always located at the strip end of both barrel and endcap chambers, to minimize the signal arrival time with respect to the interaction point. The RPC's provide timing resolution on the order of less than the 25 ns between bunch crossings, allowing the precise assignment of muon tracks to bunch crossings as well as transverse momentum measurement.

\section{Triggering and data acquisition\label{sec:cms-triggerdaq}}
% rationale, L1, HLT; muon, calorimeter, global
Every collision of proton bunches at the CMS interaction points produces a large number of particles traversing the volume of the CMS detector. With protons colliding in the LHC tunnel at a rate of 40 MHz (1 bunch crossing every 25 ns) and about 20 proton-proton collisions per bunch crossing at the design luminosity of 10$^{34}$ cm$^{-2}$s$^{-1}$, a huge amount of data is generated at a high frequency. In order to save information from only the most important events and thus respect the limitations of the electronics and computer systems that process and store this data, a method for drastically reducing the rate of data acquisition is required. The trigger system of the CMS experiment performs a rapid assessment of each event recorded, storing the data from the event only if it passes certain criteria that mark it as an event of interest. Triggering is performed in two main steps, the Level 1 (L1) Trigger and the High Level Trigger (HLT). Together, these two steps provide a combined rate reduction factor of at least 10$^6$.

The L1 Trigger consists of a system of programmable electronics, located partly in the CMS detector and partly in the underground control room near the experimental cavern. Energy deposits in calorimeter trigger towers serve as input to the local calorimeter trigger component of the L1, while track segments and hit patterns from the muon chamber serve as input to the local muon trigger component. Regional calorimeter triggers and DT and CSC track finders take the information from the local triggers and search for patterns in order to rank and sort trigger objects based on their energy or momentum and quality. Next, the global calorimeter trigger and global muon trigger take the output of their respective regional triggers and pick out the highest-ranking calorimeter and muon objects across the whole experiment. This information is finally passed to the global trigger at the end of the L1 decision chain, which uses various algorithm calculations to assess whether to reject the event completely or to accept it to be passed on to the HLT; if the event passes the L1 criteria and all the subdetectors and data acquisition (DAQ) systems are ready, then the event data are passed to the HLT. The L1 Trigger analyzes every bunch crossing, with a latency period of 3.2 $\mu$s between one bunch crossing and the distribution of the trigger decision to the front-end electronics. Its design output rate limit without data recording is 100 kHz; in practice, the final rate is on the order of 30 kHz.

When an event passes the L1 Trigger, the data is passed to the CMS DAQ system. The subdetector front-end systems store event data in buffers until the L1 Trigger decision allows them to release this data to the front-end drivers (FEDs) of the DAQ system. Event fragments from the FEDs are merged by a set of processors called the Event Builder to produce a data structure containing the complete event information, which is then passed to the Event Filter, a computer farm of about one thousand PC's. The Event Filter submits the event data to the HLT, a flexible software system implemented in the computers of the Event Filter, and also performs data quality monitoring (DQM) to assess the goodness of the data.

The HLT~\cite{Cittolin:578006} runs reconstruction and filtering algorithms on the event data. The reconstruction process builds physics objects (C++ data structures) from the raw data using a streamlined version of the CMS offline reconstruction software (which is described later in Section~\ref{sec:cms-reco}. The filtering process selects whether or not to keep an event, based on the criteria that classify it as having interesting physics content; these criteria define what is known as the HLT path, and they vary widely depending on the physics object or combinations of objects being selected. Numerous HLT paths are used for the numerous physics searches carried out by the CMS experiment. One example of an HLT path is a single-muon trigger that stores events if they contain at least one muon with $p_T$ $>$ 24 GeV and whose isolation -- measured by summing the pixel tracks and calorimeter energy deposits in a cone of fixed radius about the direction of the muon's reconstructed four-momentum -- is lower than some maximum cutoff. Other examples of HLT paths include selections on the $p_T$, isolation, and multiplicity of electrons and muons, the energy and multiplicity of jets, and the amount of missing transverse energy in an event.

From the input rate of around 100 kHz from the L1 Trigger, the HLT ultimately reduces the rate of event processing to $\mathcal{O}$(100) Hz. Datasets of raw events passing the HLT are written to permanent storage and undergo further offline processing before they are ready for use in physics studies or for calibration and data monitoring.